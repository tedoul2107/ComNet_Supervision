{% load static %}

<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="{% static 'css/style_appli.css' %}">
	<script defer src="https://use.fontawesome.com/releases/v5.15.4/js/all.js" integrity="sha384-rOA1PnstxnOBLzCLMcre8ybwbTmemjzdNlILg8O7z1lUkLXozs4DHonlDtnE7fpc" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.1.0/chartjs-plugin-datalabels.min.js" integrity="sha512-Tfw6etYMUhL4RTki37niav99C6OHwMDB2iBT5S5piyHO+ltK2YX8Hjy9TXxhE1Gm/TmAV0uaykSpnHKFIAif/A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<title>Supervision panel</title>
</head>
<body>
	<div class="container">
		<div class="topbar">
			<div class="logo">
				<h2>Bibémi Net.</h2>
			</div>
			<div class="search">
				<input type="text" id="search" placeholder="search here">
				<label for="search"><i class="fas fa-search"></i></label>
			</div>
			<i class="fas fa-bell"></i>
			<div class="user">
				<img src="{% static 'img/user.png' %}" alt="">
			</div>
		</div>
		<div class="sidebar">
			<ul>
				<li>
					<a href="/map">
						<i class="fas fa-map"></i>
						<div>Cartographie</div>
					</a>
				</li>
				<li>
					<a href="/router/">
						<i class="fas fa-server"></i>
						<div>Equipements</div>
					</a>
				</li>
				<li>
					<a href="/application/" class="map">
						<i class="fas fa-window-restore"></i>
						<div>Applications</div>
					</a>
				</li>
				<li>
					<a href="/alert/">
						<i class="fas fa-exclamation-triangle"></i>
						<div>Alertes</div>
					</a>
				</li>
				<li>
					<a href="#">
						<i class="fas fa-users"></i>
						<div>Utilisateurs</div>
					</a>
				</li>
				<li>
					<a href="#">
						<i class="fas fa-chart-bar"></i>
						<div>Analytics</div>
					</a>
				</li>
				<li>
					<a href="#">
						<i class="fas fa-cog"></i>
						<div>Settings</div>
					</a>
				</li>
				<li>
					<a href="/">
						<i class="fas fa-sign-out-alt"></i>
						<div>Exit</div>
					</a>
				</li>
				<li>
					<a href="#">
						<i class="fas fa-question"></i>
						<div>Help</div>
					</a>
				</li>
			</ul>
		</div>
		<div class="main">

			<div class="charts">

				<div class="chart chart-traffic">
					<h2>Trafic de l'application</h2>
					<div id='traffic2'></div>
				</div>

				<div class="chart">
					<h2>Répartition des codes d'état</h2>
					<canvas id='status_code'></canvas>
				</div>

				<div class="chart">
					<h2>Méthode</h2>
					<canvas id='method'></canvas>
				</div>

				<div class="chart">
					<h2>Requêtes les plus utilisées</h2>
					<canvas id='request'></canvas>
				</div>

				<div class="chart chart-log">
					<h2>Fichiers de journalisation</h2>
					<table class="logs">
						<thead>
						<tr>
							<th>@ Ip</th>
							<th>Datetime</th>
							<th>Method</th>
							<th>Request</th>
							<th>Size</th>
							<th>Status</th>
							<th>Signification</th>
						</tr>
						</thead>
						<tbody>
						<tr>
							<td>192.168.1.3</td>
							<td>2022-10-24 15:38:19.302722</td>
							<td class="signification">POST</td>
							<td>/themes/sark-press/</td>
							<td>2851</td>
							<td><p class="status status-ok">200</p></td>
							<td class="signification">OK</td>
						</tr>

						<tr>
							<td>93.72.5.44</td>
							<td>2022-10-24 15:39:19.302722</td>
							<td class="signification">GET</td>
							<td>/sark-press/stylesheet/</td>
							<td>4015</td>
							<td><p class="status status-ok">200</p></td>
							<td class="signification">OK</td>
						</tr>

						<tr>
							<td>93.72.5.44</td>
							<td>2022-10-24 15:39:20.302722</td>
							<td class="signification">GET</td>
							<td>/sark-press/stylesheet/logo</td>
							<td>2554</td>
							<td><p class="status status-ok">200</p></td>
							<td class="signification">OK</td>
						</tr>

						<tr>
							<td>93.72.5.44</td>
							<td>2022-10-24 15:39:25.302722</td>
							<td class="signification">GET</td>
							<td>/sark-press/stylesheet/logo/msg</td>
							<td>7854</td>
							<td><p class="status status-ok">200</p></td>
							<td class="signification">OK</td>
						</tr>

						<tr>
							<td>188.123.231.205</td>
							<td>2022-10-24 15:39:26.302722</td>
							<td class="signification">GET</td>
							<td>/sark-press/stylesheet/logo</td>
							<td>2554</td>
							<td><p class="status status-ok">200</p></td>
							<td class="signification">OK</td>
						</tr>

						<tr>
							<td>185.26.180.145</td>
							<td>2022-10-24 15:39:26.302722</td>
							<td class="signification">GET</td>
							<td>/sark-press/stylesheet/logo</td>
							<td>2554</td>
							<td><p class="status status-error">404</p></td>
							<td class="signification">Page Not Found</td>
						</tr>

						<tr>
							<td>185.26.180.147</td>
							<td>2022-10-24 15:39:30.302722</td>
							<td class="signification">GET</td>
							<td>/sark-press/stylesheet/logo</td>
							<td>2554</td>
							<td><p class="status status-error">404</p></td>
							<td class="signification">Page Not Found</td>
						</tr>

						<tr>
							<td>93.84.16.70</td>
							<td>2022-10-24 15:38:40.302722</td>
							<td class="signification">POST</td>
							<td>/themes/sark-press/</td>
							<td>2859</td>
							<td><p class="status status-ok">200</p></td>
							<td class="signification">Ok</td>
						</tr>

						<tr>
							<td>46.53.218.162</td>
							<td>2022-10-24 15:38:45.302722</td>
							<td class="signification">GET</td>
							<td>/themes/sark-press/msg</td>
							<td>2859</td>
							<td><p class="status status-ok">200</p></td>
							<td class="signification">Ok</td>
						</tr>

						<tr>
							<td>66.249.81.208</td>
							<td>2022-10-24 15:38:46.302722</td>
							<td class="signification">PUT</td>
							<td>/themes/sark-press</td>
							<td>5874</td>
							<td><p class="status status-error">500</p></td>
							<td class="signification">Internal Error on Server</td>
						</tr>

						</tbody>
					</table>
				</div>

			</div>

		</div>
	</div>

	<script>
		var options = {
			series: [{
				name: 'entrante',
				  data: [4023, 7985, 3600, 5023, 6941, 2301, 2978]
				}],
				  chart: {
				  height: 350,
				  type: 'area'
				},
				dataLabels: {
				  enabled: false
				},
				stroke: {
				  curve: 'smooth'
				},
				xaxis: {
				  type: 'datetime',
				  categories: ["2018-09-19T00:00:00.000Z", "2018-09-19T01:30:00.000Z", "2018-09-19T02:30:00.000Z", "2018-09-19T03:30:00.000Z", "2018-09-19T04:30:00.000Z", "2018-09-19T05:30:00.000Z", "2018-09-19T06:30:00.000Z"]
				},
				tooltip: {
				  x: {
					format: 'dd/MM/yy HH:mm'
				  },
				},
		};

		var chart = new ApexCharts(document.querySelector("#traffic"), options);
		chart.render();
	</script>

	<script>
		var ctx = document.getElementById('status_code').getContext('2d');
		var myChart = new Chart(ctx, {
			type: 'doughnut',
			data: {
				labels: ['200', '404', '403', '504', '500', '301'],
				datasets: [{
					label: 'Status code',
					data: [150, 20, 10, 4, 3, 13],
					backgroundColor: [
						'rgba(41, 155, 99, 1)',
						'rgba(54, 162, 235, 1)',
						'rgba(255, 206, 86, 1)',
						'rgba(120, 46, 139, 1)',
						'rgba(153, 102, 255, 1)',
						'rgba(255, 159, 64, 1)'
					],
					borderColor: [
						'rgba(41, 155, 99, 1)',
						'rgba(54, 162, 235, 1)',
						'rgba(255, 206, 86, 1)',
						'rgba(120, 46, 139, 1)',
						'rgba(153, 102, 255, 1)',
						'rgba(255, 159, 64, 1)'
					],
					borderWidth: 2
				}]
			},
			options: {
				maintainAspectRatio: true,
				responsive: true,
				plugins : {
					datalabels : {
						color: 'white',
						align: 'center',
						font: {
							weight: 'bold',
							size: 14
						}
            		}
        		}
			},
			plugins:[ChartDataLabels]
		});
	</script>

	<script>
		var ctx = document.getElementById('method').getContext('2d');
		var myChart = new Chart(ctx, {
			type: 'pie',
			data: {
				labels: ['GET', 'POST', 'PUT', 'DELETE'],
				datasets: [{
					label: 'Méthodes',
					data: [125, 50, 20, 5],
					backgroundColor: [
						'rgba(75, 192, 192, 1)',
						'rgba(255, 206, 86, 1)',
						'rgba(153, 102, 255, 1)',
						'rgba(255, 159, 64, 1)'
					],
					borderColor: [
						'rgba(75, 192, 192, 1)',
						'rgba(255, 206, 86, 1)',
						'rgba(153, 102, 255, 1)',
						'rgba(255, 159, 64, 1)'
					],
					borderWidth: 2
				}]
			},
			options: {
				maintainAspectRatio: true,
				responsive: true,
				plugins : {
					datalabels : {
						color: 'white',
						align: 'center',
						font: {
							weight: 'bold',
							size: 16
						}
            		}
        		}
			},
			plugins:[ChartDataLabels]
		});
	</script>

	<script>
		var ctx = document.getElementById('request').getContext('2d');
		var myChart = new Chart(ctx, {
			type: 'polarArea',
			data: {
				labels: ['/content/app', '/wp-connect', '/enable/access', '/message/type'],
				datasets: [{
					label: 'Equipements',
					data: [29, 36, 20, 15],
					backgroundColor: [
						'rgb(255, 99, 132)',
					    'rgb(75, 192, 192)',
					    'rgb(255, 205, 86)',
					    'rgb(201, 203, 207)',
					    'rgb(54, 162, 235)'
					],
					borderColor: [
						'rgb(255, 99, 132)',
					    'rgb(75, 192, 192)',
					    'rgb(255, 205, 86)',
					    'rgb(201, 203, 207)',
					    'rgb(54, 162, 235)'
					],
					borderWidth: 2
				}]
			},
			options: {
				maintainAspectRatio: true,
				responsive: true,
				plugins : {
					datalabels : {
						color: 'white',
						align: 'center',
						font: {
							weight: 'bold',
							size: 16
						}
            		}
        		}
			},
			plugins:[ChartDataLabels]
		});
	</script>



	 <script>
      window.Promise ||
        document.write(
          '<script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"><\/script>'
        )
      window.Promise ||
        document.write(
          '<script src="https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20171210/classList.min.js"><\/script>'
        )
      window.Promise ||
        document.write(
          '<script src="https://cdn.jsdelivr.net/npm/findindex_polyfill_mdn"><\/script>'
        )
    </script>





    <script>
      // Replace Math.random() with a pseudo-random number generator to get reproducible results in e2e tests
      // Based on https://gist.github.com/blixt/f17b47c62508be59987b
      var _seed = 12;
      Math.random = function() {
        _seed = _seed * 16807 % 2147483647;
        return (_seed - 1) / 2147483646;
      };
    </script>

    <script>
  var lastDate = 0;
  var data = []
  var TICKINTERVAL = 1000
  let XAXISRANGE = 10000
  function getDayWiseTimeSeries(baseval, count, yrange) {
    var i = 0;
    while (i < count) {
      var x = baseval;
      var y = Math.floor(Math.random() * (yrange.max - yrange.min + 1)) + yrange.min;

      data.push({
        x, y
      });
      lastDate = baseval
      baseval += TICKINTERVAL;
      i++;
    }
  }

  getDayWiseTimeSeries(new Date().getTime(), 15, {
    min: 2000,
    max: 10000
  })

  function getNewSeries(baseval, yrange) {
    var newDate = baseval + TICKINTERVAL;
    lastDate = newDate

    for(var i = 0; i< data.length - 10; i++) {
      data[i].x = newDate - XAXISRANGE - TICKINTERVAL
      data[i].y = 0
    }

    data.push({
      x: newDate,
      y: Math.floor(Math.random() * (yrange.max - yrange.min + 1)) + yrange.min
    })
  }

  function resetData(){
    // Alternatively, you can also reset the data at certain intervals to prevent creating a huge series
    data = data.slice(data.length - 1000, data.length);
  }
  </script>




	<script>
		var options = {
          series: [{
          data: data.slice()
        }],
          chart: {
          id: 'realtime',
          height: 350,
          type: 'area',
          animations: {
            enabled: true,
            easing: 'linear',
            dynamicAnimation: {
              speed: 1000
            }
          },
          toolbar: {
            show: true
          },
          zoom: {
            enabled: true
          }
        },
        dataLabels: {
          enabled: false
        },
        stroke: {
          curve: 'smooth'
        },
        markers: {
          size: 0
        },
        xaxis: {
          type: 'datetime',
          range: XAXISRANGE,
        },
        yaxis: {
          max: 11000,
          min: 900
        },
        legend: {
          show: false
        },
        };

        var chart = new ApexCharts(document.querySelector("#traffic2"), options);
        chart.render();


        window.setInterval(function () {
        getNewSeries(lastDate, {
          min: 2000,
          max: 10000
        })

        chart.updateSeries([{
          data: data
        }])
      }, 1000)


	</script>

</body>
</html>
